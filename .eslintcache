[{"/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/index.js":"1","/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/reportWebVitals.js":"2","/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/store/index.js":"3","/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/router/index.jsx":"4","/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/store/common/global.js":"5","/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/store/common/config.js":"6","/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/pages/loader/loaderSec/index.jsx":"7","/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/pages/logs/index.jsx":"8","/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/pages/home/index.jsx":"9","/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/utils/getCombBySum.js":"10","/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/store/activity/index.js":"11"},{"size":542,"mtime":1643079726092,"results":"12","hashOfConfig":"13"},{"size":362,"mtime":1643079726094,"results":"14","hashOfConfig":"13"},{"size":469,"mtime":1643094871458,"results":"15","hashOfConfig":"13"},{"size":2396,"mtime":1643094871458,"results":"16","hashOfConfig":"13"},{"size":188,"mtime":1643079726095,"results":"17","hashOfConfig":"13"},{"size":151,"mtime":1643079726095,"results":"18","hashOfConfig":"13"},{"size":293,"mtime":1643094871458,"results":"19","hashOfConfig":"13"},{"size":291,"mtime":1643094871458,"results":"20","hashOfConfig":"13"},{"size":9494,"mtime":1643094871458,"results":"21","hashOfConfig":"13"},{"size":3542,"mtime":1643079726095,"results":"22","hashOfConfig":"13"},{"size":153,"mtime":1643094871458,"results":"23","hashOfConfig":"13"},{"filePath":"24","messages":"25","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"kkesff",{"filePath":"26","messages":"27","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"28","messages":"29","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"30","messages":"31","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"32","usedDeprecatedRules":"33"},{"filePath":"34","messages":"35","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"33"},{"filePath":"36","messages":"37","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"33"},{"filePath":"38","messages":"39","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"33"},{"filePath":"40","messages":"41","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"33"},{"filePath":"42","messages":"43","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"44"},{"filePath":"45","messages":"46","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"47","messages":"48","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"33"},"/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/index.js",[],"/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/reportWebVitals.js",[],"/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/store/index.js",[],"/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/router/index.jsx",["49"],"import React, { Component, lazy, Suspense } from 'react'\nimport { BrowserRouter, HashRouter, Switch, Route, Redirect } from 'react-router-dom'\nimport { inject, observer } from 'mobx-react'\nimport { upperFirst, camelCase } from 'lodash';\nimport { Spin } from 'antd'\n\n/**\n * 懒加载引入页面\n */\nconst LoaderLoaderSec = lazy(() => import('@/pages/loader/loaderSec'))\n\n/**\n * @description 不自动加载的页面集合，同pages的name格式（首字母大写的驼峰）\n * 需要手动引入加载\n */\nconst ignorePage = ['LoaderLoaderSec']\n/**\n * 使用文件夹路径及文件夹名自动加载和命名路由\n * @description 统一加载src/pages下所有index.js/jsx，生成路由和component。路由使用-连接，无大写（文件夹名中间的大写转小写前面拼-，开头的只转小写）\n * @return {} [{ component, name, path }, ...]\n */\nconst pages = []\nconst pagesLoader = require.context('@/pages', true, /index\\.(jsx|js)$/i)\npagesLoader.keys().forEach((fileName) => {\n  const component = pagesLoader(fileName).default\n  const name = upperFirst(camelCase(`${fileName.replace(/\\.\\/|\\/index\\.\\w+$/ig, '')}`.split(/\\/|-/ig)));\n  if (ignorePage.includes(name)) return\n  let path = `${fileName.replace(/^\\.|\\/index\\.\\w+$/ig, '')}`\n  const capitalize = (s) => { \n    let words = s.split('')\n    const reg = /^[A-Z]+$/\n    for (let i = 0;i < words.length;i++) {\n      if (reg.test(words[i])) {\n        words[i] = `${['/', '-'].includes(words[i - 1]) ? '' : '-'}${words[i].toLowerCase()}`\n      }\n    }\n     return words.join('')\n  }\n  path = `${capitalize(path)}`\n  pages.push({\n    component,\n    name,\n    path\n  })\n})\n\nconst Fallback = (\n  <Spin />\n)\n\n@inject('commonGlobalStore')\n@observer\nclass Index extends Component {\n  render () {\n    const { loading, loadingTips } = this.props.commonGlobalStore\n    return (\n      <HashRouter>\n        <Suspense fallback={Fallback}>\n          <Spin spinning={loading} tip={loadingTips}>\n            <Switch>\n                {\n                  pages.length && pages.map(r => (\n                    <Route key={r.name} path={r.path} component={r.component} />\n                  ))\n                }\n                <Route path=\"/tt/:id?\" component={LoaderLoaderSec} />\n                <Redirect path=\"*\" to=\"/home\" />\n            </Switch>\n          </Spin>\n        </Suspense>\n      </HashRouter>\n    )\n  }\n}\n\nexport default Index",["50","51"],"/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/store/common/global.js",[],"/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/store/common/config.js",[],"/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/pages/loader/loaderSec/index.jsx",[],"/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/pages/logs/index.jsx",[],"/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/pages/home/index.jsx",["52"],"import React, { Component } from 'react'\nimport { inject, observer } from 'mobx-react'\nimport XLSX from 'xlsx'\nimport { pickBy, trim, mapKeys } from 'lodash'\nimport classNames from 'classnames'\nimport { Form, Input, Switch, InputNumber, Upload, Button, message, Modal, Result } from 'antd'\nimport { InboxOutlined, SmileOutlined, MehOutlined } from '@ant-design/icons'\nimport getCombBySum from '@/utils/getCombBySum'\n\nimport './index.less'\n\nconst { Item } = Form;\nconst { Dragger } = Upload\n\nconst initialValues = {\n  useDefault: true,\n  targetCount: 0,\n  tolerance: 0,\n  excelUrl: null,\n  column: 'A',\n  startRow: 1,\n  endRow: null,\n  targetSum: 0\n}\n\n@inject('commonConfigStore', 'commonGlobalStore')\n@observer\nclass Index extends Component {\n  \n  constructor (props) {\n    super(props)\n    this.formItemLayout = {\n      labelCol: {\n        xs: { span: 24 },\n        sm: { span: 5 },\n      },\n      wrapperCol: {\n        xs: { span: 24 },\n        sm: { span: 12 },\n      },\n    }\n  }\n\n  componentDidMount() {\n    this.forceUpdate()\n  }\n  \n  normFile = e => {\n    console.log('Upload event:', e)\n    const { file } = e\n    const { status, name, response } = file\n    if (status !== 'uploading') {\n      console.log(file)\n    }\n    if (status === 'done') {\n      message.success(`${name} file uploaded successfully.`)\n      return response.path;\n    } else if (status === 'error') {\n      message.error(`${name} file upload failed.`)\n    }\n  }\n\n  resetForm = () => {\n    this.form.resetFields()\n    this.forceUpdate()\n  }\n\n  onChange = values => {\n    console.log('onChange', values)\n    if (Object.keys(values)[0] === 'column') {\n      const { setFieldsValue } = this.form\n      setFieldsValue({\n        column: trim(values.column).replace(/[^a-zA-Z]*/ig, '').toUpperCase()\n      })\n    }\n    this.forceUpdate()\n  }\n\n  onFinish = values => {\n    console.log('onFinish', values)\n    this.props.commonGlobalStore.loading = true\n    this.props.commonGlobalStore.loadingTips = '请稍候，完成后将下载xlsx'\n    this.readWorkbookFromRemoteFile(this.form.getFieldValue('excelUrl'), this.calculation)\n  }\n\n  readWorkbookFromRemoteFile(url, callback) {\n    const xhr = new XMLHttpRequest()\n    xhr.open('get', url, true)\n    xhr.responseType = 'arraybuffer'\n    xhr.onload = () => {\n      if (xhr.status === 200) {\n        const data = new Uint8Array(xhr.response)\n        const workbook = XLSX.read(data, {type: 'array'})\n        if (callback) callback(workbook)\n      }\n    }\n    xhr.send()\n  }\n\n  calculation = async workbook => {\n    const { column: handleColumnKey, startRow, endRow, targetSum, targetCount, tolerance } = this.form.getFieldsValue()\n    try { \n      const sheetNames = workbook.SheetNames; // 工作表名称集合\n      const worksheet = workbook.Sheets[sheetNames[0]]; // 这里我们只读取第一张sheet\n      // 1、pickBy获取匹配选择列数据集合{A1: {}, A2: {}, ...}，2、mapKeys去掉key中的字母（A2 => 2） {1: {}, 2: {}, ...}\n      const worksheetColumn = mapKeys(pickBy(worksheet, (value, key) => {\n        const reg = new RegExp(`(${handleColumnKey})([0-9]+)`)\n        return reg.test(key)\n      }), (value, key) => {\n        return +key.replace(handleColumnKey, '')\n      })\n      // 获取选择列最大行标 number\n      const autoColumnEndRow = Math.max(...Object.keys(worksheetColumn))\n      // 获取最终需要进行组合的数集合，过滤非数字\n      const nums = Object.entries(worksheetColumn).map(([key, value]) => {\n        if (key >= startRow && key <= (endRow || autoColumnEndRow) && +value.v) {\n          return +value.v\n        }\n        return null\n      }).filter(d => d)\n      console.log(nums, targetSum, targetCount, tolerance)\n      const result = await new getCombBySum(nums, targetSum, targetCount, tolerance)\n      console.log('结果集:', result)\n      if (!result || !result.length) {\n        return this.handleFaceBack({\n          icon: null,\n          content: <Result\n            icon={<MehOutlined />}\n            title=\"什么也没有!\"\n          />\n        })\n      }\n      this.downloadXlsx(result)\n      // [\n      //   [152, 167, 174, 186, 193, 196, 215, 225, 228, 232, 250, 278, 291, 303, 344, 405, 431, 661, 954, 1032, 1204],\n      //   [152, 167, 174, 186, 196, 215, 225, 228, 232, 250, 278, 291, 344, 360, 405, 661, 728, 793, 1032, 1208],\n      //   [152, 167, 174, 186, 193, 196, 215, 225, 232, 250, 291, 360, 405, 431, 661, 793, 954, 1032, 1208],\n      //   [152, 167, 174, 186, 193, 196, 215, 250, 278, 291, 303, 344, 661, 728, 793, 954, 1032, 1208],\n      //   [152, 167, 174, 186, 193, 215, 232, 250, 344, 405, 431, 661, 728, 793, 954, 1032, 1208],\n      //   [152, 167, 174, 193, 232, 291, 344, 360, 405, 431, 661, 728, 793, 954, 1032, 1208],\n      //   [193, 215, 232, 278, 291, 344, 360, 405, 431, 661, 728, 793, 954, 1032, 1208]\n      // ]\n    } catch (e) {\n      console.error('readWorkbookFromRemoteFile error', e)\n      message.error(String(e))\n    } finally {\n      this.props.commonGlobalStore.loading = false\n    }\n  }\n\n  downloadXlsx = (data) => {\n    try {\n      const filename = 'result.xlsx' // 文件名称\n      /**\n       * 直接new Array(length).fill([])填充的话其中填充的数组为共用内存地址，故多一步map转化\n      */\n      const witerData = new Array(Math.max(...data.map(d => d.length))).fill(0).map(() => [])\n      data.forEach((d, i) => {\n        d.forEach((u, j) => {\n          witerData[j][i] = u\n        })\n      })\n      const ws_name = 'Sheet1' // Excel第一个sheet的名称\n      const wb = XLSX.utils.book_new()\n      const ws = XLSX.utils.aoa_to_sheet(witerData)\n      XLSX.utils.book_append_sheet(wb, ws, ws_name);  // 将数据添加到工作薄\n      XLSX.writeFile(wb, filename); // 导出Excel\n    } catch (e) {\n      throw e\n    }\n  }\n\n  handleFaceBack = (config) => {\n    const modal = Modal.info()\n    modal.update(prevConfig => ({\n      ...prevConfig,\n      ...config\n    }))\n  }\n\n  render () {\n    const { getFieldValue } = this.form || {}\n    return (\n      <>\n        <Form\n          name=\"validate\"\n          ref={el => this.form = el}\n          {...this.formItemLayout}\n          onFinish={this.onFinish}\n          onValuesChange={this.onChange}\n          initialValues={initialValues}\n        >\n          <Item name=\"useDefault\" label=\"是否使用默认配置\" valuePropName=\"checked\" extra={getFieldValue && getFieldValue('useDefault') && `默认操作数：${getFieldValue('targetCount')}，容差：${getFieldValue('tolerance')}`}>\n            <Switch />\n          </Item>\n          <Item label=\"操作数\" className={classNames({ 'fly': getFieldValue && getFieldValue('useDefault') })}>\n            <span className=\"ant-form-text\">由</span>\n            <Item name=\"targetCount\" noStyle>\n              <InputNumber min={0} />\n            </Item>\n            <span className=\"ant-form-text\">个数字组成</span>\n          </Item>\n          <Item label=\"容差\" className={classNames({ 'fly': getFieldValue && getFieldValue('useDefault') })}>\n            <span className=\"ant-form-text\">误差</span>\n            <Item name=\"tolerance\" noStyle>\n              <InputNumber min={0} />\n            </Item>\n            <span className=\"ant-form-text\">以内都没关系</span>\n          </Item>\n          <Item label=\"上传excel\">\n            <Item name=\"excelUrl\" valuePropName=\"file\" getValueFromEvent={this.normFile} noStyle  rules={[{ required: true, message: 'excel必传！' }]}>\n              <Dragger\n                name='file'\n                action='https://niu.souche.com/upload/aliyun'\n              >\n                <p className=\"ant-upload-drag-icon\">\n                  <InboxOutlined />\n                </p>\n                <p className=\"ant-upload-text\">Click or drag file to this area to upload</p>\n                <p className=\"ant-upload-hint\">\n                  Support for a single or bulk upload. Strictly prohibit from uploading company data or other\n                  band files\n                </p>\n              </Dragger>\n            </Item>\n          </Item>\n          <Item label=\"取哪列的数据\">\n            <Item name=\"column\" noStyle hasFeedback rules={[{ required: true, message: '取哪列的数据必填!' }]}>\n              <Input />\n            </Item>\n          </Item>\n          <Item label=\"行\" className=\"row\">\n            <Item name=\"startRow\" noStyle hasFeedback rules={[{ required: true, message: '从第几行开始必填!' }]}>\n              <InputNumber min={0} placeholder=\"从第几行开始\" style={{ width: 'calc(50% - 5px)' }} />\n            </Item>\n            <Item name=\"endRow\" noStyle>\n              <InputNumber min={0} placeholder=\"到第几行结束\" style={{ marginLeft: '10px', width: 'calc(50% - 5px)' }} />\n            </Item>\n            <span className=\"ant-form-text\" style={{ whiteSpace: 'nowrap', alignSelf: 'center' }}>不填默认到底</span>\n          </Item>\n          <Item label=\"目标总值\">\n            <Item name=\"targetSum\" noStyle hasFeedback rules={[{ required: true, message: '目标总值必填!' }]}>\n              <InputNumber />\n            </Item>\n          </Item>\n          <Item wrapperCol={{ span: 12, offset: 5 }} className=\"action\">\n            <Button type=\"primary\" htmlType=\"submit\">\n              Submit\n            </Button>\n            <Button type=\"primary\" onClick={this.resetForm}>\n              重置\n            </Button>\n          </Item>\n        </Form>\n      </>\n    )\n  }\n}\n\nexport default Index\n","/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/utils/getCombBySum.js",[],"/Users/zhanshichao/Documents/my-space/excel-getcombbysum-h5/src/store/activity/index.js",[],{"ruleId":"53","severity":1,"message":"54","line":2,"column":10,"nodeType":"55","messageId":"56","endLine":2,"endColumn":23},{"ruleId":"57","replacedBy":"58"},{"ruleId":"59","replacedBy":"60"},{"ruleId":"53","severity":1,"message":"61","line":7,"column":25,"nodeType":"55","messageId":"56","endLine":7,"endColumn":38},"no-unused-vars","'BrowserRouter' is defined but never used.","Identifier","unusedVar","no-native-reassign",["62"],"no-negated-in-lhs",["63"],"'SmileOutlined' is defined but never used.","no-global-assign","no-unsafe-negation"]